
Multi-doc progress:   0%|                                                                                                         | 0/221 [00:00<?, ?it/s]
Query:  How has the UV luminosity function of galaxies evolved from z~4 to z~8 according to analyses of deep HST data?
Retrieved Documents:
  1404/1404.5299_arXiv.txt
  2202/2202.04142_arXiv.txt
  1301/1301.6162_arXiv.txt
  1405/1405.1040_arXiv.txt
  1704/1704.05996_arXiv.txt
  1710/1710.11131_arXiv.txt
  1806/1806.05187_arXiv.txt
  2211/2211.10035_arXiv.txt
  9605/astro-ph9605170_arXiv.txt
  1005/1005.0386_arXiv.txt
Relevant Documents:
  arxiv/1201/1201.0755_arXiv.txt
  arxiv/1212/1212.4819_arXiv.txt
  arxiv/1208/1208.3529_arXiv.txt
  arxiv/0309/0309070_arXiv.txt
  arxiv/0302/0302212_arXiv.txt
  arxiv/1207/1207.2727_arXiv.txt
  arxiv/1212/1212.0860_arXiv.txt
  arxiv/1211/1211.6804_arXiv.txt
  arxiv/1212/1212.5222_arXiv.txt
  arxiv/1301/1301.1228_arXiv.txt
  arxiv/0707/0707.2080_arXiv.txt
  arxiv/1211/1211.3663_arXiv.txt
  arxiv/1210/1210.8417_arXiv.txt
  arxiv/1008/1008.3901_arXiv.txt
Query:  What are the key observational measurements of the UV luminosity density from z=0 to z=8 that are used to constrain the cosmic star formation history?
Retrieved Documents:
  1405/1405.1040_arXiv.txt
  2202/2202.04142_arXiv.txt
  1404/1404.5299_arXiv.txt
  1708/1708.03373_arXiv.txt
  1301/1301.6162_arXiv.txt
  1006/1006.1903_arXiv.txt
  9910/astro-ph9910104_arXiv.txt
  2211/2211.10035_arXiv.txt
  1710/1710.11131_arXiv.txt
  1211/1211.2825_arXiv.txt
Relevant Documents:
  arxiv/0810/0810.2788_arXiv.txt
  arxiv/0411/0411364_arXiv.txt
  arxiv/1106/1106.1994_arXiv.txt
  arxiv/1212/1212.4819_arXiv.txt
  arxiv/1208/1208.3529_arXiv.txt
  arxiv/0411/0411391_arXiv.txt
  arxiv/0411/0411424_arXiv.txt
  arxiv/1109/1109.1005_arXiv.txt
  arxiv/0609/0609016_arXiv.txt

Multi-doc progress:   1%|▉                                                                                                | 2/221 [00:02<05:17,  1.45s/it]
Query:  How does the specific star formation rate of galaxies evolve with redshift and stellar mass, and what are the implications for galaxy growth and the cosmic star formation history?
Retrieved Documents:
  1308/1308.2030_arXiv.txt
  0409/astro-ph0409394_arXiv.txt
  0808/0808.2642_arXiv.txt
  0803/0803.1489_arXiv.txt
  1002/1002.0386.txt
  0101/astro-ph0101135_arXiv.txt
  0803/0803.0414_arXiv.txt
  1011/1011.0724_arXiv.txt
  1609/1609.03956_arXiv.txt
  1306/1306.2424_arXiv.txt
Relevant Documents:
  arxiv/0311/0311060_arXiv.txt
  arxiv/0701/0701924_arXiv.txt
  arxiv/1202/1202.0290_arXiv.txt
  arxiv/9910/9910104_arXiv.txt
  arxiv/0411/0411775_arXiv.txt
  arxiv/0705/0705.2831_arXiv.txt
  arxiv/0312/0312474_arXiv.txt
  arxiv/1011/1011.6370_arXiv.txt
  arxiv/1108/1108.0933_arXiv.txt
  arxiv/0703/0703653_arXiv.txt
Multi-doc progress:   1%|█▎                                                                                               | 3/221 [00:04<05:54,  1.63s/it]
Traceback (most recent call last):
  File "/Users/charlesoneill/retrieval/src/bag_of_words.py", line 117, in <module>
    main()
  File "/Users/charlesoneill/retrieval/src/bag_of_words.py", line 114, in main
    evaluate_main(retrieval_system, "BagOfWordsAll")
  File "/Users/charlesoneill/retrieval/src/../evaluation/evaluate.py", line 144, in main
    results = evaluator.evaluate('../data/single_paper.json', '../data/multi_paper.json', top_k=10)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charlesoneill/retrieval/src/../evaluation/evaluate.py", line 37, in evaluate
    multi_results = self._evaluate_multi_document(multi_doc_file, top_k)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charlesoneill/retrieval/src/../evaluation/evaluate.py", line 76, in _evaluate_multi_document
    retrieved_docs = self.retrieval_system.retrieve(query, top_k=top_k)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charlesoneill/retrieval/src/bag_of_words.py", line 103, in retrieve
    similarities = cosine_similarity(query_vector, self.tfidf_matrix).flatten()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charlesoneill/miniconda3/envs/jsalt/lib/python3.12/site-packages/sklearn/utils/_param_validation.py", line 213, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charlesoneill/miniconda3/envs/jsalt/lib/python3.12/site-packages/sklearn/metrics/pairwise.py", line 1676, in cosine_similarity
    K = safe_sparse_dot(X_normalized, Y_normalized.T, dense_output=dense_output)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charlesoneill/miniconda3/envs/jsalt/lib/python3.12/site-packages/sklearn/utils/extmath.py", line 208, in safe_sparse_dot
    ret = a @ b
          ~~^~~
  File "/Users/charlesoneill/miniconda3/envs/jsalt/lib/python3.12/site-packages/scipy/sparse/_base.py", line 669, in __matmul__
    return self._matmul_dispatch(other)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charlesoneill/miniconda3/envs/jsalt/lib/python3.12/site-packages/scipy/sparse/_base.py", line 580, in _matmul_dispatch
    return self._matmul_sparse(other)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charlesoneill/miniconda3/envs/jsalt/lib/python3.12/site-packages/scipy/sparse/_compressed.py", line 529, in _matmul_sparse
    other = self.__class__(other)  # convert to this format
            ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charlesoneill/miniconda3/envs/jsalt/lib/python3.12/site-packages/scipy/sparse/_compressed.py", line 35, in __init__
    arg1 = arg1.asformat(self.format)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charlesoneill/miniconda3/envs/jsalt/lib/python3.12/site-packages/scipy/sparse/_base.py", line 409, in asformat
    return convert_method(copy=copy)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charlesoneill/miniconda3/envs/jsalt/lib/python3.12/site-packages/scipy/sparse/_csc.py", line 52, in tocsr
    csc_tocsr(M, N,
KeyboardInterrupt