


































































Epoch 1/10: 100%|█████████████████████████████| 266/266 [02:14<00:00,  1.97it/s]
Epoch 2/10:   1%|▏                              | 2/266 [00:01<02:36,  1.69it/s]
Epoch 1, Average Loss: 0.7950































































Epoch 2/10: 100%|█████████████████████████████| 266/266 [02:09<00:00,  2.05it/s]
Epoch 3/10:   0%|                                       | 0/266 [00:00<?, ?it/s]
Epoch 2, Average Loss: 0.6156






























































Epoch 3/10:  99%|████████████████████████████▊| 264/266 [02:04<00:00,  2.06it/s]
Epoch 3, Average Loss: 0.5503
Epoch 3/10: 100%|█████████████████████████████| 266/266 [02:05<00:00,  2.12it/s]





























































Epoch 4/10:  99%|████████████████████████████▋| 263/266 [02:03<00:01,  2.19it/s]
Epoch 4, Average Loss: 0.5164
Epoch 4/10: 100%|█████████████████████████████| 266/266 [02:04<00:00,  2.13it/s]






























































Epoch 5/10:  98%|████████████████████████████▌| 262/266 [02:04<00:01,  2.20it/s]
Epoch 5, Average Loss: 0.4959
Epoch 5/10: 100%|█████████████████████████████| 266/266 [02:06<00:00,  2.10it/s]






























































Epoch 6/10:  99%|████████████████████████████▋| 263/266 [02:05<00:01,  2.09it/s]
Epoch 6, Average Loss: 0.4833
Epoch 6/10: 100%|█████████████████████████████| 266/266 [02:06<00:00,  2.10it/s]






























































Epoch 7/10: 100%|█████████████████████████████| 266/266 [02:07<00:00,  2.08it/s]
Epoch 8/10:   0%|                                       | 0/266 [00:00<?, ?it/s]
Epoch 7, Average Loss: 0.4774






























































Epoch 8/10:  98%|████████████████████████████▌| 262/266 [02:04<00:02,  1.87it/s]
Epoch 8, Average Loss: 0.4794
Epoch 8/10: 100%|█████████████████████████████| 266/266 [02:05<00:00,  2.12it/s]



































































Epoch 9/10:  94%|███████████████████████████▎ | 250/266 [11:45<00:45,  2.82s/it]
Traceback (most recent call last):
  File "/Users/christineye/retrieval/saerch/topk_sae.py", line 197, in <module>
    main()
  File "/Users/christineye/retrieval/saerch/topk_sae.py", line 192, in main
    train(ae, train_loader, optimizer, epochs, k, auxk_coef, clip_grad, model_name=model_name)
  File "/Users/christineye/retrieval/saerch/topk_sae.py", line 133, in train
    unit_norm_decoder_grad_adjustment_(ae)
  File "/Users/christineye/retrieval/saerch/topk_sae.py", line 71, in unit_norm_decoder_grad_adjustment_
    proj = torch.sum(autoencoder.decoder.weight * autoencoder.decoder.weight.grad, dim=0, keepdim=True)
KeyboardInterrupt