




























Epoch 1/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 266/266 [00:59<00:00,  4.51it/s]
Epoch 2/50:   1%|█▏                                                                                                            | 3/266 [00:00<00:59,  4.40it/s]
Epoch 1, Average Loss: 0.6128





























Epoch 2/50:  99%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▊ | 263/266 [00:58<00:00,  4.57it/s]
Epoch 2, Average Loss: 0.4635
Epoch 2/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 266/266 [00:59<00:00,  4.49it/s]





























Epoch 3/50:  99%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▏| 264/266 [00:59<00:00,  4.53it/s]
Epoch 3, Average Loss: 0.4113
Epoch 3/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 266/266 [00:59<00:00,  4.45it/s]





























Epoch 4/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 266/266 [00:59<00:00,  4.46it/s]
Epoch 4, Average Loss: 0.3807
Model saved to checkpoints/64_9216_128_final_epoch_4.pth




























Epoch 5/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 266/266 [00:59<00:00,  4.50it/s]
Epoch 6/50:   1%|█▏                                                                                                            | 3/266 [00:00<00:57,  4.55it/s]
Epoch 5, Average Loss: 0.3589





























Epoch 6/50:  98%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▉  | 261/266 [00:58<00:01,  4.50it/s]
Epoch 6, Average Loss: 0.3420
Epoch 6/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 266/266 [00:59<00:00,  4.47it/s]




























Epoch 7/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 266/266 [00:58<00:00,  4.53it/s]
Epoch 8/50:   0%|▍                                                                                                             | 1/266 [00:00<01:02,  4.24it/s]
Epoch 7, Average Loss: 0.3284





























Epoch 8/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 266/266 [00:59<00:00,  4.46it/s]
Epoch 9/50:   2%|█▋                                                                                                            | 4/266 [00:00<00:58,  4.46it/s]
Epoch 8, Average Loss: 0.3175





























Epoch 9/50:  99%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▏| 264/266 [00:59<00:00,  4.59it/s]
Epoch 9, Average Loss: 0.3087
Epoch 9/50: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 266/266 [00:59<00:00,  4.48it/s]




























Epoch 10/50:  98%|████████████████████████████████████████████████████████████████████████████████████████████████████████▉  | 261/266 [00:57<00:01,  4.41it/s]
Epoch 10/50: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 266/266 [00:58<00:00,  4.54it/s]
Epoch 11/50:   2%|█▋                                                                                                           | 4/266 [00:00<00:59,  4.41it/s]





























Epoch 11/50: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 266/266 [01:00<00:00,  4.39it/s]
Epoch 12/50:   0%|▍                                                                                                            | 1/266 [00:00<01:01,  4.33it/s]
Epoch 11, Average Loss: 0.2953





























Epoch 12/50:  99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▊ | 263/266 [00:58<00:00,  4.51it/s]
Epoch 12, Average Loss: 0.2902
Epoch 12/50: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 266/266 [00:58<00:00,  4.52it/s]




























Epoch 13/50: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 266/266 [00:58<00:00,  4.52it/s]
Epoch 14/50:   0%|▍                                                                                                            | 1/266 [00:00<01:01,  4.30it/s]
Epoch 13, Average Loss: 0.2857





























Epoch 14/50: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 266/266 [00:59<00:00,  4.44it/s]
Epoch 15/50:   0%|▍                                                                                                            | 1/266 [00:00<01:02,  4.21it/s]
Epoch 14, Average Loss: 0.2819





























Epoch 15/50:  99%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▏| 264/266 [00:58<00:00,  4.59it/s]
Epoch 15, Average Loss: 0.2785
Epoch 15/50: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 266/266 [00:59<00:00,  4.49it/s]




























Epoch 16/50: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 266/266 [00:58<00:00,  4.52it/s]
Epoch 17/50:   1%|▊                                                                                                            | 2/266 [00:00<01:01,  4.26it/s]
Epoch 16, Average Loss: 0.2755

































































Epoch 17/50:  99%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▏| 264/266 [02:12<00:01,  1.27it/s]
Epoch 17/50: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████| 266/266 [02:13<00:00,  1.99it/s]
Epoch 18/50:   0%|▍                                                                                                            | 1/266 [00:00<03:19,  1.33it/s]


































Epoch 18/50:  29%|███████████████████████████████▎                                                                            | 77/266 [01:13<03:00,  1.05it/s]
Traceback (most recent call last):
  File "/Users/charlesoneill/retrieval/saerch/topk_sae.py", line 197, in <module>
    main()
  File "/Users/charlesoneill/retrieval/saerch/topk_sae.py", line 192, in main
    train(ae, train_loader, optimizer, epochs, k, auxk_coef, clip_grad, model_name=model_name)
  File "/Users/charlesoneill/retrieval/saerch/topk_sae.py", line 118, in train
    loss.backward()
  File "/Users/charlesoneill/miniconda3/envs/saerch/lib/python3.12/site-packages/torch/_tensor.py", line 525, in backward
    torch.autograd.backward(
  File "/Users/charlesoneill/miniconda3/envs/saerch/lib/python3.12/site-packages/torch/autograd/__init__.py", line 267, in backward
    _engine_run_backward(
  File "/Users/charlesoneill/miniconda3/envs/saerch/lib/python3.12/site-packages/torch/autograd/graph.py", line 744, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt